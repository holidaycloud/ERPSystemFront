<div class="row">
    <div class="col-xs-12 col-sm-7 col-md-7 col-lg-4">
        <h1 class="page-title txt-color-blueDark"><i class="fa-fw fa fa-group"></i> 企业管理 <span>>网站配置</span></h1>
    </div>
</div>

<div class="row">
    <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
        <!-- Widget ID (each widget will need unique ID)-->
        <div class="jarviswidget jarviswidget-color-blueDark" data-widget-custombutton="true">
            <header>
                <span class="widget-icon"> <i class="fa fa-check"></i> </span>
                <h2>企业网站功能</h2>
            </header>
            <!-- widget div-->
            <div>
                <!-- end widget edit box -->
                <!-- widget content -->
                <div class="modal-body no-padding">
                    <form id="openWeb" class="smart-form">
                        <fieldset>
                            <section>
                                <div class="row">
                                    <div class="col col-1">
                                        <h6>是否启用</h6>
                                    </div>
                                    <div class="col col-11">
                                        <label class="checkbox">
                                            <input type="checkbox" name="checkbox" id="isOpen" name="isOpen">
                                            <i></i>
                                        </label>
                                    </div>
                                </div>
                            </section>
                        </fieldset>
                    </form>
                </div>
                <!-- end widget content -->

            </div>
            <!-- end widget div -->
        </div>
    </div>
</div>

<div class="row" id="webcfg">
    <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
        <!-- Widget ID (each widget will need unique ID)-->
        <div class="jarviswidget jarviswidget-color-blueDark" data-widget-custombutton="true">
            <!-- widget options:
            usage: <div class="jarviswidget" id="wid-id-0" data-widget-editbutton="false">

            data-widget-colorbutton="false"
            data-widget-editbutton="false"
            data-widget-togglebutton="false"
            data-widget-deletebutton="false"
            data-widget-fullscreenbutton="false"
            data-widget-custombutton="false"
            data-widget-collapsed="true"
            data-widget-sortable="false"

            -->
            <header>
                <span class="widget-icon"> <i class="fa fa-wrench"></i> </span>
                <h2>企业网站配置</h2>
            </header>

            <!-- widget div-->
            <div>
                <!-- end widget edit box -->

                <!-- widget content -->
                <div class="modal-body no-padding">
                    <form id="webcfgForm" class="smart-form">
                        <fieldset>
                            <section>
                                <div class="row">
                                    <label class="label col col-3">企业名称</label>
                                    <div class="col col-8">
                                        <label class="input">
                                            <input type="text" name="webcfgName" id="webcfgName" placeholder="企业名称">
                                        </label>
                                    </div>
                                </div>
                            </section>

                            <section>
                                <div class="row">
                                    <label class="label col col-3">企业网址</label>
                                    <div class="col col-8">
                                        <label class="input">
                                            <input type="text" name="webcfgDomain" id="webcfgDomain" placeholder="企业网址,如：http://www.holidaycloud.cn">
                                        </label>
                                    </div>
                                </div>
                            </section>

                            <section>
                                <div class="row">
                                    <label class="label col col-3">企业地址</label>
                                    <div class="col col-8">
                                        <label class="input">
                                            <input type="text" name="webcfgAddress" id="webcfgAddress" placeholder="企业地址">
                                        </label>
                                    </div>
                                </div>
                            </section>

                            <section>
                                <div class="row">
                                    <label class="label col col-3">企业电话</label>
                                    <div class="col col-8">
                                        <label class="input">
                                            <input type="text" name="webcfgTel" id="webcfgTel" placeholder="企业电话，如：021-12345678">
                                        </label>
                                    </div>
                                </div>
                            </section>

                            <section>
                                <div class="row">
                                    <label class="label col col-3">企业邮箱</label>
                                    <div class="col col-8">
                                        <label class="input">
                                            <input type="text" name="webcfgEmail" id="webcfgEmail" placeholder="企业邮箱，如：holidaycloud@holidaycloud.cn">
                                        </label>
                                    </div>
                                </div>
                            </section>

                            <section>
                                <div class="row">
                                    <label class="label col col-3">企业坐标</label>
                                    <div class="col col-4">
                                        <label class="label">经度</label>
                                        <label class="input">
                                            <input type="text" name="webcfgLon" id="webcfgLon" placeholder="企业地址经度，如：31.456343">
                                        </label>
                                    </div>
                                    <div class="col col-4">
                                        <label class="label">纬度</label>
                                        <label class="input">
                                            <input type="text" name="webcfgLat" id="webcfgLat" placeholder="企业地址纬度，如：121.131674">
                                        </label>
                                    </div>
                                </div>
                            </section>

                            <section>
                                <div class="row">
                                    <label class="label col col-3">网站LOGO</label>

                                    <div class="col col-4">
                                        <div class="input input-file">
                                        <span class="button">
                                            <input type="file" id="webcfgLogo" name="webcfgLogo"
                                                   onchange="this.parentNode.nextSibling.value = this.value">添加网站LOGO</span><input
                                                    type="text" id="webcfgLogoName" placeholder="选择上传的网站LOGO" readonly="">
                                            </span>
                                        </div>
                                    </div>
                                    <div class="col col-2">
                                        <button type="button" id="btnLogoUpload" class="btn btn-primary">上传</button>
                                    </div>
                                </div>
                            </section>
                            <section>
                                <div class="row">
                                    <label class="label col col-3"> </label>

                                    <div id="logos" class="listdiv clearfix">

                                    </div>
                                </div>
                            </section>

                            <section>
                                <div class="row">
                                    <label class="label col col-3">二维码图片</label>

                                    <div class="col col-4">
                                        <div class="input input-file">
                                        <span class="button">
                                            <input type="file" id="webcfgImage" name="webcfgImage"
                                                   onchange="this.parentNode.nextSibling.value = this.value">添加二维码图片</span><input
                                                    type="text" id="webcfgImgName" placeholder="选择上传的二维码图片" readonly="">
                                            </span>
                                        </div>
                                    </div>
                                    <div class="col col-2">
                                        <button type="button" id="btnUpload" class="btn btn-primary">上传</button>
                                    </div>
                                </div>
                            </section>
                            <section>
                                <div class="row">
                                    <label class="label col col-3"> </label>

                                    <div id="images" class="listdiv clearfix">

                                    </div>
                                </div>
                            </section>
                        </fieldset>
                        <footer>
                            <button type="button" class="btn btn-primary" id="btnWebConfig">
                                保存配置
                            </button>
                        </footer>
                    </form>
                </div>
                <!-- end widget content -->

            </div>
            <!-- end widget div -->


        </div>
    </div>
</div>
<script src="/js/ajaxfileupload.js"></script>
<script src="/js/page/ent_webconfig.js"></script>
<script type="text/javascript">
    var varObj = {};
    varObj.logo = "";
    varObj.image = "";
    var cfg = "";
    ///////////////////////////INIT PLUGIN////////////////////////////////////
    $("#webcfg").hide();
    clearWebCfgForm();
    ///////////////////////////////LOADING////////////////////////////////
    $("#ldModal").modal({
        backdrop:false,
        keyboard:false
    });
    //get weixin config
    $.ajax({
        type: "GET",
        url: "/ent/webcfg/getWebCfg",
        cache:false
    }).done(function(data, textStatus){
        if(data.error==0){
            if(data.data){
                cfg = data;
                if(data.data.isEnable){
                    setValues(cfg);
                    $("#webcfg").show();
                }
            }
        }else{
            alert(data.errorMsg);
        }
        $("#ldModal").modal("hide");
    }).fail(function(){
        $("#ldModal").modal("hide");
        alert("网络异常，请重试！");
    });
    ////////////////////////////INIT EVENT////////////////////////////////////

    //企业是否启用click event
    $("#isOpen").unbind("click").click(function(){
        if(this.checked){
            setValues(cfg);
            var params = {};
            params.isEnable = true;
            saveConfig(params);
            $("#webcfg").show();
        }else{
            $("#webcfg").hide();
            var params = {};
            params.isEnable = false;
            saveConfig(params);
        }
    });

    //upload logo click event
    $("#btnLogoUpload").unbind("click").click(function(){
        if(""===$("#webcfgLogo").val()){
            alert("请选择需要上传的LOGO！");
        }else{
            ajaxFileUpload('webcfgLogo','logos','logo');
        }
    });

    //upload qc image click event
    $("#btnUpload").unbind("click").click(function(){
        if(""===$("#webcfgImage").val()){
            alert("请选择需要上传的二维码图片！");
        }else{
            ajaxFileUpload('webcfgImage','images','image');
        }
    });

    //weixin account config save click event
    $("#btnWebConfig").unbind("click").click(function(){
        if(""===$("#webcfgName").val().trim()){
            alert("企业名称不能为空！");
            return false;
        }
        if(""===$("#webcfgDomain").val().trim()){
            alert("企业网址不能为空！");
            return false;
        }
        if(""===$("#webcfgAddress").val().trim()){
            alert("企业地址不能为空！");
            return false;
        }
        if(""===$("#webcfgTel").val().trim()){
            alert("企业电话不能为空！");
            return false;
        }
        if(""===$("#webcfgEmail").val().trim()){
            alert("企业邮箱不能为空！");
            return false;
        }
        if(""===$("#webcfgLon").val().trim()){
            alert("坐标经度不能为空！");
            return false;
        }
        if(""===$("#webcfgLat").val().trim()){
            alert("坐标纬度不能为空！");
            return false;
        }
        if(""===varObj.logo){
            alert("企业LOGO不能为空！");
            return false;
        }
        if(""===varObj.image){
            alert("企业二维码不能为空！");
            return false;
        }
        var params = {};
        params.title = $("#webcfgName").val().trim();
        params.domain = $("#webcfgDomain").val().trim();
        params.address = $("#webcfgAddress").val().trim();
        params.tel = $("#webcfgTel").val().trim();
        params.email = $("#webcfgEmail").val().trim();
        params.lat = $("#webcfgLat").val().trim();
        params.lon = $("#webcfgLon").val().trim();
        params.logo = varObj.logo;
        params.qrCode = varObj.image;
        params.isEnable = true;
        saveConfig(params);
    });
</script>